
# Sentinel - DNS Switcher

نرم افزار مدیریت DNS تحت ویندوز که به کاربر امکانات مختلفی را ارائه میدهد. 


<p align="center">
  <img src="https://github.com/user-attachments/assets/25d15874-f1b3-4c26-8597-8565a2d2637c" alt="Sentinel DNS Switcher preview"style="width:70%;">
</p>


## امکانات
- اجرا با دسترسی Administrator برای تنظیم مستقیم DNS کارت شبکه از طریق دستورهای سیستمی `netsh`.
- دسته‌بندی DNSها در سه بخش:
  - ایرانی
  - جهانی
  - کاستوم
- تست‌ها:
  - پینگ تکی برای هر DNS
  - پینگ گروهی برای تمام DNSها
  - تست کامل شامل میانگین پینگ، جیتر، پکت‌لاس و محاسبه امتیاز (Score) برای رتبه‌بندی بهترین DNS.
- تب مخصوص بازی‌ها:
  - لیست بازی‌ها (مثل Fortnite, Valorant, CS2, Apex Legends, Rainbow Six, Overwatch2) همراه با DNSهای پیشنهادی هر بازی.
  - امکان انتخاب و تست بهترین DNS برای هر بازی بر اساس نتایج تست.
- مدیریت DNS سفارشی:
  - افزودن، ویرایش و حذف DNSهای اختصاصی کاربر
  - ذخیره‌سازی پایدار در فایل JSON تا بین اجراها حفظ شود.
- ابزارهای سریع شبکه:
  - ریست DNS (بازگشت به حالت DHCP و اجرای `ipconfig /flushdns`)
  - ریست تنظیمات شبکه با `netsh` (نیازمند ریستارت سیستم پس از اجرا).
- رابط کاربری:
  - طراحی تیره (Dark) با CustomTkinter
  - راست‌به‌چپ و برچسب‌ها و متن‌ها کاملاً فارسی

`

- در صورت اجرا بدون دسترسی Administrator، برنامه تلاش می‌کند خودش را مجدداً با سطح دسترسی ادمین اجرا کند تا امکان تغییر DNS بدون خطا فراهم شود.
- در اولین اجرا، اگر فایل‌های تنظیمات وجود نداشته باشند، به صورت خودکار ساخته می‌شوند:
  - `dns_list.json` 
  - `games_list.json` 



## ساختار فایل‌ها


- `main.py`  
  فایل اصلی برنامه که شامل:
  - کلاس اصلی رابط کاربری (پنجره، تب‌ها، دکمه‌ها و فریم‌ها)
  - منطق تست پینگ، تست کامل و امتیازدهی
  - منطق اعمال DNS روی کارت شبکه انتخاب‌شده
  - مدیریت تب DNS، تب بازی‌ها و تب تنظیمات است.

- `dns_list.json`  
  فایل تنظیمات DNS که DNSها را در سه دسته `ایرانی`, `خارجی`, `کاستوم` ذخیره می‌کند.  
.

- `games_list.json`  
  فایل تنظیمات بازی‌ها که برای هر بازی چند دی ان اس پیشنهادی نگه می‌دارد.  
 
- `assets/ModamFaNum-Black.ttf`  
  فونت فارسی برای استفاده در رابط کاربری؛ در صورت وجود، هنگام اجرا لود می‌شود.

- `assets/icon.ico`  
  آیکن اختصاصی برنامه که در عنوان پنجره استفاده می‌شود؛ در صورت موجود بودن، روی پنجره اصلی و پنجره‌های فرعی تنظیم می‌شود.
.


## نحوه کارکرد

### انتخاب کارت شبکه

- برنامه با اجرای `netsh interface show interface` لیست اینترفیس‌های شبکه را می‌گیرد.
- اینترفیس‌های متصل (Connected) در اولویت هستند.
- برای جلوگیری از انتخاب اینترفیس‌های مجازی، نام‌هایی که شامل کلیدواژه‌هایی مانند vmware, virtual, vmnet, loopback, hyper-v, vpn, tap, tunnel, vbox هستند تا حد امکان کنار گذاشته می‌شوند تا کارت شبکه واقعی (مثل Wi-Fi یا Ethernet) انتخاب شود.
- کاربر می‌تواند از تب تنظیمات:
  - لیست کارت‌های شبکه را رفرش کند.
  - کارت شبکه فعال را به صورت دستی از منوی Option انتخاب کند.

### اعمال DNS

- براساس پروتکل انتخابی (IPv4 یا IPv6)، دستورات `netsh` مناسب برای تنظیم DNS اولیه و ثانویه روی اینترفیس انتخاب‌شده اجرا می‌شوند.
- در صورت موفقیت، پیام وضعیت مثبت در نوار پایین نمایش داده می‌شود.
- اگر اعمال DNS با خطا مواجه شود (مثلاً به دلیل دسترسی نداشتن یا نامعتبر بودن اینترفیس)، پیام خطای مناسب نمایش داده می‌شود.

### تست پینگ ساده

- برای تست ساده، از دستور `ping` با ارسال یک بسته (`-n 1`) و تایم‌اوت مشخص استفاده می‌شود.
- خروجی `ping` تحلیل می‌شود:
  - اگر عبارت `TTL=` در خروجی نباشد یا بازگشت خطا باشد، پینگ ناموفق محسوب می‌شود.
  - اگر عبارت `< 1ms` مشاهده شود، مقدار تأخیر 1 میلی‌ثانیه در نظر گرفته می‌شود.
  - در غیر این صورت، مقدار بر حسب `ms` از متن خروجی استخراج و به عنوان پینگ ثبت می‌شود.
- اگر پینگ موفق نباشد، مقدار بینهایت برای آن DNS در نظر گرفته می‌شود.

### تست کامل (پینگ، جیتر، پکت‌لاس و امتیاز)

- برای هر DNS چندین بار پینگ انجام می‌شود (تعداد قابل تنظیم در کد، مثلاً 5 بار).
- از نتایج این پینگ‌ها:
  - میانگین پینگ محاسبه می‌شود.
  - پکت‌لاس به صورت درصد بسته‌های از دست‌رفته نسبت به کل دفعات تست محاسبه می‌شود.
  - جیتر به صورت میانگین اختلاف بین زمان پاسخ‌های متوالی شبکه محاسبه می‌شود.
- در ادامه، از یک فرمول ساده برای محاسبه امتیاز نهایی (از 0 تا 100) استفاده می‌شود که در آن:
  - پینگ بالاتر
  - جیتر بالاتر
  - و پکت‌لاس بیشتر
  باعث کاهش امتیاز می‌شوند.
- نتیجه نهایی به صورت لیستی از DNSها به همراه پینگ، جیتر، پکت‌لاس و امتیاز و همچنین رتبه‌بندی نمایش داده می‌شود.

---

## تب بازی‌ها

- در تب بازی‌ها، برای هر بازی یک کارت اختصاصی نمایش داده می‌شود.
- روی هر کارت، نام بازی و یک دکمه برای مشاهده و تست DNSهای پیشنهادی وجود دارد.
- با کلیک روی دکمه، پنجره‌ای باز می‌شود که:
  - لیست DNSهای پیشنهادی مخصوص آن بازی را نمایش می‌دهد.
  - امکان تست پینگ و انتخاب بهترین DNS برای بازی را فراهم می‌کند.
- می‌توان بر اساس نتایج تست کامل، DNS بهینه برای آن بازی را انتخاب و روی کارت شبکه اعمال کرد.

---

## مدیریت DNS سفارشی

- با دکمه «افزودن DNS» کاربر می‌تواند:
  - برای DNS خود یک نام انتخاب کند.
  - IP اصلی و در صورت نیاز IP ثانویه وارد کند.
- برنامه IPها را اعتبارسنجی می‌کند:
  - اگر IP نامعتبر باشد، پیام خطا نمایش داده می‌شود.
  - نام‌های تکراری اجازه ثبت مجدد ندارند.
- در دسته `custom`:
  - دکمه‌های «ویرایش» و «حذف» برای هر DNS وجود دارد.
  - حذف تنها برای DNSهایی که توسط کاربر ثبت شده‌اند فعال است.
- تمام تغییرات در `dns_list.json` ذخیره می‌شود و بین اجراهای مختلف برنامه حفظ می‌شود.

---

## ابزارهای سریع شبکه

در تب تنظیمات، بخشی برای «ابزارهای سریع» وجود دارد که شامل:

- ریست DNS:
  - تنظیم DNS کارت شبکه روی حالت خودکار (DHCP).
  - اجرای `ipconfig /flushdns` برای پاکسازی کش DNS سیستم.
  - نمایش پیام موفقیت یا خطا.

- ریست شبکه:
  - اجرای مجموعه‌ای از دستورات `netsh` برای ریست تنظیمات شبکه.
  - پس از اجرا معمولاً نیاز به ریستارت ویندوز است.
  - هشدار قبل از اجرا نمایش داده می‌شود تا کاربر مطمئن باشد.


## اطلاعات نسخه و سازنده

- نام برنامه: Sentinel - DNS Switcher
- نسخه: 1.0.0 (Early Access)
- سازنده: aliMousavi
- وب‌سایت سازنده :`https://raminetcv.ir/`
- [دانلود Sentinel - DNS Switcher](https://github.com/ramihast/sentinel_dns-switcher/releases/download/v1.0.0/Sentinel.-.DNS.Switcher.exe)
 

---
## درباره پروژه

این پروژه در قالب یک **پژوهش تحقیقاتی دانشگاهی** آماده شده است و هدف آن بررسی و بهبود عملکرد سامانه‌های DNS برای کاربردهای عمومی و گیمینگ است.  

این پروژه تحت نظارت و راهنمایی استاد سرکارخانم کیمیایی آماده سازی شده است.
 
[Farzaneh Kimiaei](https://www.linkedin.com/in/farzaneh-kimiaei)


از تمامی افرادی که در طول انجام این پژوهش همراه و حامی این پروژه بودند سپاس‌گزاری می‌شود، به‌ویژه:

[Sean Sina Farimani](https://www.linkedin.com/in/sean-s-farimani/)  
[Ali Kavoosi](https://www.linkedin.com/in/ali-kavoos)


همراهی، مشارکت و بازخوردهای ارزشمند آن‌ها نقش مهمی در شکل‌گیری و بهبود این پروژه داشته است.
